<!DOCTYPE html><!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Babun - a windows shell you will love | Babun</title><meta name="author" content="pronounced "Baboon""><link rel="stylesheet" href="/stylesheets/styles.css"><script src="/javascripts/vendor/custom.modernizr.js"></script></head><body class="antialiased"><nav class="top-bar"><ul class="title-area"><li class="name"><h1><a href="/">Babun (pronounced Baboon)</a></h1></li></ul><li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li><section class="top-bar-section"><ul class="right"><li class="divider"></li><li><a href="/">About</a></li><li class="divider"></li><li><a href="/development/">Development</a></li></ul></section></nav><div class="container"><header><div class="row"><div class="large-8 columns hero"><h1>Babun</h1><p><strong>a windows shell you will love!</strong></p></div><div class="large-4 columns hero"><div class="actions"><a class="button secondary" href="http://github.com/babun/babun" style="color: #6d180b; max-width: 220px;"><i class="icon-download icon-2x pull-left"></i>Download latest stable version</a><a class="button secondary" href="http://github.com/babun/babun" style="max-width: 220px;"><i class="icon-github icon-2x pull-left"></i>Get source from GitHub</a></div></div></div></header><div class="row"><div class="large-12 columns"><div class="row"><div class="large-12 columns"><div class="sect1">
<h2 id="development"><a class="anchor" href="#development"></a>Development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="project-structure"><a class="anchor" href="#project-structure"></a>Project structure</h3>
<div class="paragraph">
<p>The project consists of four main modules.</p>
</div>
<div class="sect3">
<h4 id="babun-packages"><a class="anchor" href="#babun-packages"></a>babun-packages</h4>
<div class="paragraph">
<p>The main goal of the babun-packages module is to download the cygwin packages listed in the <code>conf/cygwin.x86.packages</code> file.
The abovementioned packages will be downloaded together with the whole dependency tree. Repositories which the packages are downloaded from are listed in the <code>conf/cygwin.repositories</code> file. At the beginning the first repository is taken, if a package is not available in this repo the second repo is used, etc. The process continues untill all packages have been downloaded.</p>
</div>
<div class="paragraph">
<p>All downloaded packages are stored in the <code>target/babun-packages</code> folder.</p>
</div>
</div>
<div class="sect3">
<h4 id="babun-cygwin"><a class="anchor" href="#babun-cygwin"></a>babun-cygwin</h4>
<div class="paragraph">
<p>The main goal of the babun-cygwin module is to download and invoke the native cygwin.exe installer. The packages downloaded by the babun-packages module are used as the input - all of them will be installed in the offline cygwin installation.</p>
</div>
<div class="paragraph">
<p>It is not trivial to install and zip a local instance of Cygwin - there are problems with the symlinks as the symlink-file-flags are lost during the compresion process. Babun can work it around though. At first, just after the installaion, the <code>symlinks_find.sh</code> script is invoked in order to store the list of all cygwin&#8217;s symlinks. This file is delivered in the babun&#8217;s core. Then, after babun is installed from the zip file on the user&#8217;s host the <code>symlinks_repair.sh</code> script is invoked - it will correct all the broken symlinks listed in the abovementioned file.</p>
</div>
<div class="paragraph">
<p>Preinstalled cygwin is located in the <code>target/babun-cygwin</code> folder.</p>
</div>
</div>
<div class="sect3">
<h4 id="babun-core"><a class="anchor" href="#babun-core"></a>babun-core</h4>
<div class="paragraph">
<p>The main goal of the babun-core module is to install babun&#8217;s core along with all the plugins. <code>install.sh</code> script is invoked during the creation of the distribution package in order to preinstall the plugins. Whenver babun is installed on the user&#8217;s host the <code>install_home.sh</code> script is invoke in order to install the babun-related files to the cygwin-user&#8217;s home folder.</p>
</div>
<div class="paragraph">
<p>Preinstalled cygwin with installed babun is located in the <code>target/babun-cygwin</code> folder.</p>
</div>
</div>
<div class="sect3">
<h4 id="babun-dist"><a class="anchor" href="#babun-dist"></a>babun-dist</h4>
<div class="paragraph">
<p>The main goal of the <code>babun-dist</code> module is to zip the ready-made instance of babun and copy some installation scripts on the top.
After the build has finished babun zip distribution is ready!</p>
</div>
<div class="paragraph">
<p>Distribution package is located in the <code>target/babun-dist</code> folder.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="building-from-source"><a class="anchor" href="#building-from-source"></a>Building from source</h3>
<div class="paragraph">
<p>The project is regularly build on Jenkins, on a slave node running Windows. The Windows OS is required to fully build the distribution package as one of the goals invokes the native Cygwin installer. The artifacts created by each module are cached in the target folder after a successful build. This mechanism is not intelligent to calculate the diffs so if you would like to fully rebuild a module make sure to invoke the <code>clean</code> goal before the <code>package</code> goal. For now it&#8217;s not possible to invoke a build of a selective modules only.</p>
</div>
<div class="paragraph">
<p>In order to build the dist package invoke:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">groovy build.groovy package</pre>
</div>
</div>
<div class="paragraph">
<p>In order to clean the project target folder invoke:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">groovy build.groovy clean</pre>
</div>
</div>
<div class="paragraph">
<p>In order to publish the release version to bintray invoke:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">groovy build.groovy release</pre>
</div>
</div>
<div class="paragraph">
<p>The release goal expects the following environment variables: <code>bintray_user</code> and <code>bintray_secret</code></p>
</div>
</div>
<div class="sect2">
<h3 id="developing-a-plugin"><a class="anchor" href="#developing-a-plugin"></a>Developing a plugin</h3>
<div class="paragraph">
<p>Every plugins has to consist of two main files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>install.sh - a file that will be invoke during the creation of the babun&#8217;s distribution</p>
</li>
<li>
<p>install_home.sh - a file that will be invoked during the installation of babun to the user&#8217;s home folder</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Have a look at the pact plugin - it&#8217;s a perfect example of a relatively small plugin.</p>
</div>
<div class="sect3">
<h4 id="install-sh"><a class="anchor" href="#install-sh"></a>install.sh</h4>
<div class="paragraph">
<p>Its main responsibility is to install the plugin - for example to copy the plugin files to, e.g. <code>/usr/local/etc</code> or <code>/usr/local/bin</code> directories. install.sh script is also responsbile for preparing the user&#8217;s home folder template. The template files have to be copied to the <code>/usr/local/babun/home/&lt;plugin_name&gt;</code> folder.</p>
</div>
<div class="paragraph">
<p>install.sh will be invoked many times - on every plugin update if the plugin version is higher than the version of the installed plugin - thus it&#8217;s logic has to work in an incremental way.</p>
</div>
<div class="paragraph">
<p>The script has to begin with the following statement:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">source "$babun/source/babun-core/tools/plugins.sh"

# plugin descriptor
plugin_name=new_plugin_name
plugin_version=1
should_install_plugin</pre>
</div>
</div>
<div class="paragraph">
<p>It will make sure to run the install.sh script only if a newer version of the plugin has been released.</p>
</div>
</div>
<div class="sect3">
<h4 id="install_home-sh"><a class="anchor" href="#install_home-sh"></a>install_home.sh</h4>
<div class="paragraph">
<p>Its main responsbility is to configure the user&#8217;s home folder with the plugin releated stuff, if necessarycopy. For example, it may copy the files from the <code>/usr/local/babun/home/&lt;plugin_name&gt;</code> folder to the user&#8217;s home folder.
It is also responsible for any other things that may be necessary during the user&#8217;s home configuration process.</p>
</div>
<div class="paragraph">
<p>install_home.sh will be invoked many times - on every plugin update if the plugin version is higher than the version of the installed plugin - thus it&#8217;s logic has to work in an incremental way.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="branches"><a class="anchor" href="#branches"></a>Branches</h3>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect2">
<h3 id="folder-structure"><a class="anchor" href="#folder-structure"></a>Folder structure</h3>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
</div></div></div></div></div></div><footer><div class="row full-width"><div class="large-6 columns"><p>&copy; Babun Team 2014.<br>Babun is licensed under the Apache License v2.</p></div><div class="large-6 columns"></div></div></footer><script>document.write('<script src=' + ('__proto__' in {} ? '/javascripts/vendor/zepto' : '/javascripts/vendor/jquery') + '.js><\/script>')</script><script src="/javascripts/foundation/foundation.js"></script><script src="/javascripts/foundation/foundation.topbar.js"></script><script>$(document).foundation();</script></body></html>